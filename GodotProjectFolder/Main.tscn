[gd_scene load_steps=28 format=3 uid="uid://dhpjwwsmokk1"]

[ext_resource type="Script" path="res://UILayer.gd" id="1_7yvvp"]
[ext_resource type="PackedScene" uid="uid://2xo541bybgl4" path="res://Player/Player.tscn" id="1_e7css"]
[ext_resource type="Shader" path="res://Vignette.gdshader" id="2_774ge"]
[ext_resource type="PackedScene" uid="uid://37s7ednup61r" path="res://Enemy.tscn" id="5_8rn2q"]
[ext_resource type="Script" path="res://KillPlane.gd" id="6_b8wgh"]
[ext_resource type="Shader" path="res://Outline.gdshader" id="6_g2mig"]
[ext_resource type="Script" path="res://CameraArm.gd" id="7_3gdnl"]
[ext_resource type="Texture2D" uid="uid://d1a0s0wr54d1a" path="res://Textures/background2.png" id="8_c8nwu"]
[ext_resource type="PackedScene" uid="uid://bn1i1cib0m8su" path="res://CharacterModel.tscn" id="8_pp5js"]
[ext_resource type="Script" path="res://NPC.gd" id="9_x4d0e"]
[ext_resource type="Material" uid="uid://dwd4v66xj57wb" path="res://Materials/ShirtMat3.tres" id="12_7tqy3"]

[sub_resource type="Environment" id="Environment_3n2rb"]
background_mode = 1
background_color = Color(0.521569, 0.521569, 0.521569, 1)
background_canvas_max_layer = 1
tonemap_mode = 2
glow_enabled = true
fog_light_energy = 2.28
fog_sun_scatter = 3.71
fog_density = 0.007

[sub_resource type="ShaderMaterial" id="ShaderMaterial_wmfup"]
shader = ExtResource("2_774ge")
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/scale = 0.75

[sub_resource type="Animation" id="Animation_028cw"]
resource_name = "Open"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:material:shader_parameter/scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.0, 0.75]
}

[sub_resource type="Animation" id="Animation_vw2r7"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:material:shader_parameter/scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.75]
}

[sub_resource type="Animation" id="Animation_tmpnv"]
resource_name = "Close"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:material:shader_parameter/scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.75, 0.0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_njwq4"]
_data = {
"Close": SubResource("Animation_tmpnv"),
"Open": SubResource("Animation_028cw"),
"RESET": SubResource("Animation_vw2r7")
}

[sub_resource type="ShaderMaterial" id="ShaderMaterial_dt056"]
render_priority = -128
shader = ExtResource("6_g2mig")
shader_parameter/depth_addend = 0.0
shader_parameter/depth_multiplier = 2.0
shader_parameter/is_inverted = false
shader_parameter/outline_color = Quaternion(0, 0, 0, 1)
shader_parameter/transparency = 0.85

[sub_resource type="QuadMesh" id="QuadMesh_x0ohu"]
material = SubResource("ShaderMaterial_dt056")
size = Vector2(2, 2)

[sub_resource type="WorldBoundaryShape3D" id="WorldBoundaryShape3D_qphd1"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_oqdx7"]
shading_mode = 2
albedo_texture = ExtResource("8_c8nwu")
uv1_scale = Vector3(3, 3, 3)
texture_filter = 0

[sub_resource type="BoxShape3D" id="BoxShape3D_45lns"]
size = Vector3(1, 2.83134, 3.4559)

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_65ouc"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_6vjel"]
albedo_color = Color(1, 1, 0, 1)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_g4pe0"]
material = SubResource("StandardMaterial3D_6vjel")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_n7aei"]
albedo_color = Color(1, 1, 0, 1)

[sub_resource type="BoxMesh" id="BoxMesh_a7kpg"]
material = SubResource("StandardMaterial3D_n7aei")
size = Vector3(0.25, 0.25, 1)

[node name="Main" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_3n2rb")

[node name="DirectionalLight3d" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.784582, -0.536958, 0.310013, -2.27666e-08, 0.5, 0.866025, -0.620025, -0.679468, 0.392291, 0, 0, 0)
shadow_enabled = true

[node name="Interface" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="UILayer" type="CanvasLayer" parent="."]
script = ExtResource("1_7yvvp")

[node name="Vignette" type="ColorRect" parent="UILayer"]
material = SubResource("ShaderMaterial_wmfup")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -209.0
offset_top = -276.0
offset_right = 231.0
offset_bottom = 254.0
grow_horizontal = 2
grow_vertical = 2

[node name="AnimationPlayer" type="AnimationPlayer" parent="UILayer/Vignette"]
libraries = {
"": SubResource("AnimationLibrary_njwq4")
}

[node name="CameraArm" type="Node3D" parent="." node_paths=PackedStringArray("target")]
transform = Transform3D(1, 0, 0, 0, 0.939692, 0.34202, 0, -0.34202, 0.939692, 0, -2, 0)
script = ExtResource("7_3gdnl")
target = NodePath("../Player")

[node name="Camera3d" type="Camera3D" parent="CameraArm"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 50)
fov = 20.0

[node name="Outline" type="MeshInstance3D" parent="CameraArm/Camera3d"]
mesh = SubResource("QuadMesh_x0ohu")
skeleton = NodePath("../../..")

[node name="KillPlane" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -20, 0)
collision_mask = 2
script = ExtResource("6_b8wgh")

[node name="CollisionShape3d" type="CollisionShape3D" parent="KillPlane"]
transform = Transform3D(5, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0)
shape = SubResource("WorldBoundaryShape3D_qphd1")

[node name="Player" parent="." instance=ExtResource("1_e7css")]

[node name="Enemy" parent="." instance=ExtResource("5_8rn2q")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5.11832, 2.34162, -20.9057)

[node name="Enemy2" parent="." instance=ExtResource("5_8rn2q")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 22.1992, 1.071, 5.80207)

[node name="Enemy3" parent="." instance=ExtResource("5_8rn2q")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8.54962, -6.18352, -20.9358)

[node name="World" type="Node3D" parent="."]

[node name="Ground" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.85856, 0)
use_collision = true
size = Vector3(20, 1, 20)
material = SubResource("StandardMaterial3D_oqdx7")

[node name="Ground2" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -8.64629, -19.9361)
use_collision = true
size = Vector3(20, 1, 20)
material = SubResource("StandardMaterial3D_oqdx7")

[node name="Ground5" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 19.9991, -8.64629, -19.9361)
use_collision = true
size = Vector3(20, 1, 20)
material = SubResource("StandardMaterial3D_oqdx7")

[node name="Ground6" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 19.9991, -14.8071, -9.57259)
use_collision = true
size = Vector3(20, 1, 20)
material = SubResource("StandardMaterial3D_oqdx7")

[node name="Ground7" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, -0.000917435, -14.8071, -9.57259)
use_collision = true
size = Vector3(20, 1, 20)
material = SubResource("StandardMaterial3D_oqdx7")

[node name="Ground3" type="CSGBox3D" parent="World"]
transform = Transform3D(0.984814, 0.173614, 0, -0.173614, 0.984814, 0, 0, 0, 1, 19.759, -3.588, 0)
use_collision = true
size = Vector3(20, 1, 20)
material = SubResource("StandardMaterial3D_oqdx7")

[node name="Ground4" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 0.984808, -0.173648, 0, 0.173648, 0.984808, -0.00806522, -0.131191, -19.8226)
use_collision = true
size = Vector3(20, 1, 20)
material = SubResource("StandardMaterial3D_oqdx7")

[node name="Platform" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.50508, -0.992314, -2.34492)
use_collision = true
size = Vector3(3.21318, 1.82408, 4.27191)

[node name="Platform2" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.0772, 0.425594, -22.1573)
use_collision = true
size = Vector3(8.62065, 1.82408, 7.8318)

[node name="House" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.21204, 3.04598, -23.1351)
use_collision = true
size = Vector3(6.10331, 3.44124, 4.21737)

[node name="Doorway" type="CSGBox3D" parent="World/House"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.568173, 1.54139)
operation = 2
use_collision = true
size = Vector3(1.60852, 2.60601, 2.54374)

[node name="House2" type="CSGBox3D" parent="World/House"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.124434, 0)
operation = 2
use_collision = true
size = Vector3(5.73805, 3.44124, 3.9174)

[node name="TransitionArea" type="Area3D" parent="World/House"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.208187, 0)
collision_mask = 2

[node name="CollisionShape3D" type="CollisionShape3D" parent="World/House/TransitionArea"]
shape = SubResource("BoxShape3D_45lns")

[node name="Platform3" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 16.4793, -2.0424, -4.69768)
use_collision = true
size = Vector3(3.21318, 1.82408, 4.27191)

[node name="Platform5" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 16.4793, -2.0424, -4.69768)
use_collision = true
size = Vector3(3.21318, 1.82408, 4.27191)

[node name="Platform4" type="CSGBox3D" parent="World"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 22.5648, -2.26276, 4.76709)
use_collision = true
size = Vector3(3.21318, 3.74997, 4.27191)

[node name="NPC" type="CharacterBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.70806, -0.343931, -7.18417)
collision_layer = 2
script = ExtResource("9_x4d0e")

[node name="CollisionShape3D" type="CollisionShape3D" parent="NPC"]
shape = SubResource("CapsuleShape3D_65ouc")

[node name="Model2" type="Node3D" parent="NPC"]
visible = false

[node name="MeshInstance3D" type="MeshInstance3D" parent="NPC/Model2"]
mesh = SubResource("CapsuleMesh_g4pe0")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="NPC/Model2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.5)
mesh = SubResource("BoxMesh_a7kpg")

[node name="Model" parent="NPC" instance=ExtResource("8_pp5js")]
transform = Transform3D(0.45, 0, 0, 0, 0.45, 0, 0, 0, 0.45, 0, -0.25, 0)

[node name="arm" parent="NPC/Model/Armature/Skeleton3D" index="0"]
material_override = ExtResource("12_7tqy3")

[node name="chest" parent="NPC/Model/Armature/Skeleton3D" index="1"]
material_override = ExtResource("12_7tqy3")

[node name="shoulder" parent="NPC/Model/Armature/Skeleton3D" index="7"]
material_override = ExtResource("12_7tqy3")

[connection signal="body_entered" from="KillPlane" to="KillPlane" method="_on_kill_plane_body_entered"]
[connection signal="body_entered" from="World/House/TransitionArea" to="UILayer" method="_on_transition_area_body_entered"]

[editable path="NPC/Model"]
